{"version":3,"sources":["all.js"],"names":["firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","db","firestore","products","collection","stores","productCategory","storeCategory","AOS","init","render","document","querySelector","url","location","href","split","decodeURI","where","orderBy","onSnapshot","querySnapshot","str","forEach","item","product","data","imgUrl","title","price","$","html","hide","querySelectorAll","innerHTML","parentElement","classList","add","storeArr","categoryObj","store","category","push","Object","values","flat","Infinity","renderStoreList","str2","storeKey","tel","time","address","storeModalShow","on","e","target","id","removeClass","modalStore","find","dataset","modalTitle","lat","latlng","lng","initMap","timePickerMin","toString","timePickerMax","datepicker","dateFormat","minDate","maxDate","timepicker","timeFormat","minTime","maxTime","addClass","fadeIn","delay","fadeOut","parent","storeLatlng","map","google","maps","Map","getElementById","zoom","center","marker","Marker","position","ready","slideToggle","event","preventDefault","siblings","history","replaceState","children","next","validate","rules","name","required","number","minlength","email","feedback","policy","errorPlacement","error","element","attr","remove","css","insertAfter","submitHandler","form","setTimeout","submit","value","length"],"mappings":"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","file":"all.js","sourcesContent":["\"use strict\"; // 寫了才能正常運行 jQuery\n\n// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDGSMcP5U44-K3qE0Y5lt77k4Bcq5sVKtU\",\n  authDomain: \"chan-sushi.firebaseapp.com\",\n  projectId: \"chan-sushi\",\n  storageBucket: \"chan-sushi.appspot.com\",\n  messagingSenderId: \"373508304619\",\n  appId: \"1:373508304619:web:6aa5d730627f26955a58ae\",\n  measurementId: \"G-F6FLCKX6C1\"\n};\n\n// 初始化 Firebase\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\nconst products = db.collection('menu');\nconst stores = db.collection('stores');\nlet productCategory = '握壽司';\nlet storeCategory = '尋找最近的店舖';\n\n// 初始化 AOS\nAOS.init();\n\n// 渲染畫面\nfunction render(){\n  if(document.querySelector('#productList')){\n    // 產品列表頁\n    // 先確定網址有無參數\n    const url = location.href.split('?type=');\n    if(url[1]){\n      productCategory = decodeURI(url[1]);\n    }\n    // 抓 api\n    products.where('category','==',productCategory).orderBy('price').onSnapshot(querySnapshot => {\n      let str = '';\n      querySnapshot.forEach(item => {\n        const product = item.data();\n        str+=`\n        <div class=\"col-xl-3 col-md-4 col-sm-6 col-12 mb-5\">\n          <div class=\"card border-0\">\n            <img src=\"${product.imgUrl}\" alt=\"${product.title}\" class=\"card-img\">\n            <div class=\"card-body d-flex justify-content-between\">\n              <h3>${product.title}</h3>\n              <p class=\"card-subtitle ml-3\">NT ${product.price}</p>\n            </div>\n          </div>\n        </div>\n        `\n      });\n      $('#productList').html(str);\n      $('#loader').hide();\n      // 第一次進入頁面時， nav-item 即可正確顯示 active class\n      document.querySelectorAll('.nav-link').forEach(item=>{\n        if(item.innerHTML === productCategory){\n          item.parentElement.classList.add('active');\n        }\n      })\n    }); \n  }else if(document.querySelector('#storeList')){\n    // 店舖列表頁\n    let storeArr = [];\n    const url = location.href.split('?type=');\n    if(url[1]){\n      storeCategory = decodeURI(url[1]);\n    }\n    if(storeCategory === '尋找最近的店舖'){\n      stores.onSnapshot(querySnapshot=>{\n        // 店舖照地區北至南順序排列，先分類成物件裡的陣列，再取出放到 storeArr 渲染\n        const categoryObj = {\n          '台北':[],\n          '新北':[],\n          '台中':[],\n          '台南':[],\n          '高雄':[],\n        };\n        querySnapshot.forEach(item => {\n          const store = item.data();\n          categoryObj[store.category].push(store);\n        });\n        storeArr = Object.values(categoryObj).flat(Infinity);\n        renderStoreList(storeArr);\n      })\n    }else{\n      stores.where('category','==',storeCategory).onSnapshot(querySnapshot =>{\n        querySnapshot.forEach(item => {\n          storeArr.push(item.data());\n        });\n        renderStoreList(storeArr);\n      })\n    }\n  }else{\n    $('#loader').hide();\n  }\n}\nfunction renderStoreList(storeArr){\n  let str = '';\n  let str2 = '';\n\n  storeArr.forEach((store,storeKey) => {\n    str+=`\n    <div class=\"col-lg-4 col-md-6 col-12 mb-5\">\n      <div class=\"card\">\n        <img src=\"${store.imgUrl}\" alt=\"${store.category}${store.title}店\" class=\"card-img\">\n        <div class=\"card-body\">\n          <h3 class=\"card-title\">${store.category}${store.title}店</h3>\n          <ul>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-telephone-fill\"></i>\n              <span class=\"ml-1\">${store.tel}</span>\n            </li>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-clock-fill\"></i>\n              <span class=\"ml-1\">${store.time[0]}:00 ~ ${store.time[1]}:00</span>\n            </li>\n            <li class=\"d-flex\">\n              <i class=\"bi bi-pin-angle-fill\"></i>\n              <span class=\"ml-1\">${store.address}</span>\n            </li>\n          </ul>\n        </div>\n        <div class=\"card-footer\">\n          <button class=\"btn btn-secondary-light modal-label-btn\" id=\"modal-label-${storeKey}\" data-modal-title=\"${store.title}\">立即訂位</button>\n          <button class=\"btn btn-outline-secondary-light ml-2\">外送點餐</button>\n        </div>\n      </div>\n    </div>\n    `\n    str2+=`\n    <div class=\"modal-outer d-none\" id=\"modal-${storeKey}\">\n      <div class=\"modal-inner\">\n        <p class=\"modal-exit mb-3\">\n          <i class=\"bi bi-x-lg\"></i>\n        </p>\n        <h3 class=\"modal-title\">${store.category}${store.title}店</h3>\n        <p class=\"modal-subtitle mb-5\">${store.address}</p>\n        <div class=\"d-md-flex justify-content-md-between\">\n          <div class=\"w-md-50 w-100 map mb-md-0 mb-5\" id=\"map-${storeKey}\">\n          </div>\n          <div class=\"w-md-50 w-100 ml-md-5\">\n            <div class=\"mb-5\">\n              <p class=\"mb-2\">預定日期：</p>\n              <input type=\"text\" class=\"datepicker w-100\">\n            </div>\n            <div class=\"mb-5\">\n              <p class=\"mb-2\">預定時段：</p>\n              <input type=\"text\" class=\"timepicker w-100\" name=\"time\" id=\"booking-time-${storeKey}\"/>\n            </div>\n            <div class=\"d-md-flex mb-5\">\n              <div class=\"w-md-50 mb-md-0 mb-5\">\n                <p class=\"mb-2\">訂位姓名：</p>\n                <input type=\"text\" class=\"w-100\"/>\n              </div>\n              <div class=\"w-md-50 ml-md-1\">\n                <p class=\"mb-2\">訂位人數：</p>\n                <input type=\"number\" class=\"w-100\"/>\n              </div>\n            </div>\n            <div class=\"mb-5\">\n              <p class=\"mb-2\">連絡信箱：</p>\n              <input type=\"text\" class=\"w-100\"/>\n            </div>\n            <button type=\"button\" class=\"btn btn-secondary-light w-100 send-rsvn\">確認訂位</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    `\n  })\n  $('#storeList').html(str);\n  $('#storeModal').html(str2);\n  $('#loader').hide();\n  // 跑完上面才綁定店舖頁訂位 modal\n  storeModalShow(storeArr);\n}\n// 店舖頁點「立即訂位」 modal 相關功能\nfunction storeModalShow(storeArr){\n  // 開啟\n  $('.modal-label-btn').on('click', function(e){\n    const storeKey = e.target.id.split('-')[2];\n    $(`#modal-${storeKey}`).removeClass('d-none');\n    const modalStore = storeArr.find(store=> store.title === e.target.dataset.modalTitle);\n    // 顯示地圖\n    const lat = modalStore.latlng[0];\n    const lng = modalStore.latlng[1];\n    initMap(lat,lng, `map-${storeKey}`);\n    // 顯示日期時間外掛\n    const timePickerMin = modalStore.time[0].toString();  \n    const timePickerMax = modalStore.time[1].toString();  \n    $(function () {\n      // datePicker\n      $(\".datepicker\").datepicker({\n        dateFormat: \"yy-mm-dd\", \n        minDate: '0',\n        maxDate: \"+1M -1D\"\n      });\n      // timePicker\n      $(`#booking-time-${storeKey}`).timepicker({\n        timeFormat: 'hh:mm p',\n        minTime: timePickerMin,\n        maxTime: timePickerMax,\n      });\n    });\n    // 送出訂單關閉 modal 彈出 alert 視窗\n    $('.send-rsvn').on('click',function(){\n      $(`#modal-${storeKey}`).addClass('d-none');\n      $('#bookingAlert').fadeIn(1000).delay(1500).fadeOut(1000);\n    })\n  })\n  // 關閉\n  // $('.modal-outer').on('click',function(){\n  //   $(this).addClass('d-none');\n  // })\n  $('.modal-exit').on('click', function(){\n    $(this).parent().parent().addClass('d-none');\n  })\n}\n// 初始化地圖 api\nfunction initMap(lat=0, lng=0, id=\"map\"){\n  let storeLatlng = { lat: lat, lng: lng };\t\n  let map = new google.maps.Map(document.getElementById(id), {\n    zoom: 15,\t//放大的倍率\n    center: storeLatlng\t//初始化的地圖中心位置\n  });\n  let marker = new google.maps.Marker({\n    position: storeLatlng,\t//marker的放置位置\n    map: map\n  });\n}\n\n$(document).ready(function () {\n  // 渲染畫面\n  render();\n  // 漢堡選單\n  $('#collapseNavbarBtn').on('click', function(){\n    $('#collapseNavbarMenu').slideToggle();\n  })  \n  // 菜單點選列表，沒被點到的移除 active class (render function 中會加上對應 active class)\n  $('.nav-link').on('click',function(event){\n    event.preventDefault(); \n    $(this).parent().siblings().removeClass('active');\n    // 如果是產品列表頁，要秀出對應資料\n    if($('#productList')){\n      productCategory = $(this)[0].innerHTML;\n      const url = `/product-list.html?type=${productCategory}`;\n      // 更新網址參數但不刷新整個頁面讓 nav-item active 消失\n      history.replaceState({url: url, title: document.title}, document.title, url);\n    }\n    render();\n  })\n  // 常見問答點選列表，點到的展開\n  $('#faqList').children().on('click', function(){\n    $(this).children().next().slideToggle();\n    $(this).children().next().addClass('active');\n  })\n  // 首頁聯絡我們表單驗證\n  $(\"#contactForm\").validate({\n    rules: {\n      name: {\n        required: true,\n      },\n      tel: {\n        required: true,\n        number: true,\n        minlength: 7,\n      },\n      email: {\n        required: true,\n        email: true,\n      },\n      feedback: {\n        required: true,\n      },\n      policy: {\n        required: true,\n      }     \n    },\n    errorPlacement:function(error, element){\n      if($(element).attr(\"name\") == \"policy\"){\n        if(element.parent().next().attr(\"class\") == \"error\"){\n          element.parent().next().remove();\n        }\n        error.css(\"display\",\"block\").insertAfter(element.parent());\n      } else {\n        error.insertAfter(element);\n      }\n    },\n    submitHandler: function(form) {\n      $('#alert').fadeIn(1000).delay(1500).fadeOut(1000);\n      setTimeout(function(){form.submit();}, 3500);\n    }       \n  });\n  // 首頁搜尋店舖，跳轉畫面秀出對應資料\n  $('#searchStoreBtnIndex').on('click',function(){\n    storeCategory = $(this).siblings()[0].value;\n    const url = `/store-location.html?type=${storeCategory}`;\n    document.location = url;\n  })\n  // 店舖頁搜尋店舖，秀出對應資料\n  $('#searchStoreLocation').on('click',function(e){\n    $('#storeLocationList').slideToggle();\n    if(e.target.innerHTML.length === 2){\n      storeCategory = e.target.innerHTML;\n      const url = `/store-location.html?type=${storeCategory}`;\n      history.replaceState({url: url, title: document.title}, document.title, url);\n      render();  \n    }\n  })\n});\n\n"]}