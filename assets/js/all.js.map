{"version":3,"sources":["all.js"],"names":["firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","db","firestore","products","collection","stores","productCategory","storeCategory","AOS","init","render","document","querySelector","url","location","href","split","decodeURI","where","orderBy","onSnapshot","querySnapshot","str","forEach","item","product","data","imgUrl","title","price","$","html","hide","querySelectorAll","innerHTML","parentElement","classList","add","storeArr","categoryObj","store","category","push","Object","values","flat","Infinity","renderStoreList","tel","time","address","ready","on","slideToggle","event","preventDefault","parent","siblings","removeClass","history","replaceState","children","next","addClass","validate","rules","name","required","number","minlength","email","feedback","policy","errorPlacement","error","element","attr","remove","css","insertAfter","submitHandler","form","submit","value"],"mappings":"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","file":"all.js","sourcesContent":["\"use strict\"; // 寫了才能正常運行 jQuery\n\n// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDGSMcP5U44-K3qE0Y5lt77k4Bcq5sVKtU\",\n  authDomain: \"chan-sushi.firebaseapp.com\",\n  projectId: \"chan-sushi\",\n  storageBucket: \"chan-sushi.appspot.com\",\n  messagingSenderId: \"373508304619\",\n  appId: \"1:373508304619:web:6aa5d730627f26955a58ae\",\n  measurementId: \"G-F6FLCKX6C1\"\n};\n\n// 初始化 Firebase\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\nconst products = db.collection('menu');\nconst stores = db.collection('stores');\nlet productCategory = '握壽司';\nlet storeCategory = '尋找最近的店舖';\n\n// 初始化 AOS\nAOS.init();\n\n// 渲染畫面\nfunction render(){\n  if(document.querySelector('#productList')){\n    // 產品列表頁\n    // 先確定網址有無參數\n    const url = location.href.split('?type=');\n    if(url[1]){\n      productCategory = decodeURI(url[1]);\n    }\n    // 抓 api\n    products.where('category','==',productCategory).orderBy('price').onSnapshot(querySnapshot => {\n      let str = '';\n      querySnapshot.forEach(item => {\n        const product = item.data();\n        str+=`\n        <div class=\"col-md-4 col-sm-6 col-12 mb-5\">\n          <div class=\"card border-0\">\n            <img src=\"${product.imgUrl}\" alt=\"${product.title}\" class=\"card-img\">\n            <div class=\"card-body\">\n              <h3 class=\"card-title mb-0\">${product.title}</h3>\n              <p class=\"text-center font-2\">${product.price} 元</p>\n            </div>\n          </div>\n        </div>\n        `\n      });\n      $('#productList').html(str);\n      $('#productListTitle').html(productCategory);\n      $('#loader').hide();\n      // 第一次進入頁面時， nav-item 即可正確顯示 active class\n      document.querySelectorAll('.nav-link').forEach(item=>{\n        if(item.innerHTML === productCategory){\n          item.parentElement.classList.add('active');\n        }\n      })\n    }); \n  }else if(document.querySelector('#storeList')){\n    // 店舖列表頁\n    let storeArr = [];\n    const url = location.href.split('?type=');\n    if(url[1]){\n      storeCategory = decodeURI(url[1]);\n    }\n    if(storeCategory === '尋找最近的店舖'){\n      stores.onSnapshot(querySnapshot=>{\n        // 店舖照地區北至南順序排列，先分類成物件裡的陣列，再取出放到 storeArr 渲染\n        const categoryObj = {\n          '台北':[],\n          '新北':[],\n          '台中':[],\n          '台南':[],\n          '高雄':[],\n        };\n        querySnapshot.forEach(item => {\n          const store = item.data();\n          categoryObj[store.category].push(store);\n        });\n        storeArr = Object.values(categoryObj).flat(Infinity);\n        renderStoreList(storeArr);\n      })\n    }else{\n      stores.where('category','==',storeCategory).onSnapshot(querySnapshot =>{\n        querySnapshot.forEach(item => {\n          storeArr.push(item.data());\n        });\n        renderStoreList(storeArr);\n      })\n    }\n  }else{\n    $('#loader').hide();\n  }\n}\nfunction renderStoreList(storeArr){\n  let str = '';\n  storeArr.forEach(store => {\n    str+=`\n    <div class=\"col-lg-4 col-md-6 col-12 mb-5\">\n      <div class=\"card\">\n        <img src=\"${store.imgUrl}\" alt=\"${store.category}${store.title}店\" class=\"card-img\">\n        <div class=\"card-body\">\n          <h3 class=\"card-title\">${store.category}${store.title}店</h3>\n          <ul>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-telephone-fill\"></i>\n              <span class=\"ml-1\">${store.tel}</span>\n            </li>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-clock-fill\"></i>\n              <span class=\"ml-1\">${store.time[0]}:00 ~ ${store.time[1]}:00</span>\n            </li>\n            <li class=\"d-flex\">\n              <i class=\"bi bi-pin-angle-fill\"></i>\n              <span class=\"ml-1\">${store.address}</span>\n            </li>\n          </ul>\n        </div>\n        <div class=\"card-footer\">\n          <a href=\"#\" class=\"btn btn-secondary-light\">立即訂位</a>\n          <a href=\"#\" class=\"btn btn-outline-secondary-light ml-2\">外送點餐</a>\n        </div>\n      </div>\n    </div>\n    `\n  })\n  $('#storeList').html(str);\n  $('#loader').hide();\n}\n\n$(document).ready(function () {\n  // 渲染畫面\n  render();\n  // 漢堡選單\n  $('#collapseNavbarBtn').on('click', function(){\n    $('#collapseNavbarMenu').slideToggle();\n  })  \n  // 菜單點選列表，沒被點到的移除 active class (render function 中會加上對應 active class)\n  $('.nav-link').on('click',function(event){\n    event.preventDefault(); \n    $(this).parent().siblings().removeClass('active');\n    // 如果是產品列表頁，要秀出對應資料\n    if($('#productList')){\n      productCategory = $(this)[0].innerHTML;\n      const url = `/product-list.html?type=${productCategory}`;\n      // 更新網址參數但不刷新整個頁面讓 nav-item active 消失\n      history.replaceState({url: url, title: document.title}, document.title, url);\n    }\n    render();\n  })\n  // 常見問答點選列表，點到的展開\n  $('#faqList').children().on('click', function(){\n    $(this).children().next().slideToggle();\n    $(this).children().next().addClass('active');\n  })\n  // 首頁聯絡我們表單驗證\n  $(\"#contactForm\").validate({\n    rules: {\n      name: {\n        required: true,\n      },\n      tel: {\n        required: true,\n        number: true,\n        minlength: 7,\n      },\n      email: {\n        required: true,\n        email: true,\n      },\n      feedback: {\n        required: true,\n      },\n      policy: {\n        required: true,\n      }     \n    },\n    errorPlacement:function(error, element){\n      if($(element).attr(\"name\") == \"policy\"){\n        if(element.parent().next().attr(\"class\") == \"error\"){\n          element.parent().next().remove();\n        }\n        error.css(\"display\",\"block\").insertAfter(element.parent());\n      } else {\n        error.insertAfter(element);\n      }\n    },\n    submitHandler: function(form) {\n      form.submit();\n    }       \n  });\n  // 首頁搜尋店舖，跳轉畫面秀出對應資料\n  $('#searchStoreBtnIndex').on('click',function(){\n    storeCategory = $(this).siblings()[0].value;\n    const url = `/store-location.html?type=${storeCategory}`;\n    document.location = url;\n  })\n  // 店舖頁搜尋店舖，秀出對應資料\n  $('#searchStoreBtnLocation').on('click',function(){\n    storeCategory = $(this).siblings()[0].value;\n    const url = `/store-location.html?type=${storeCategory}`;\n    history.replaceState({url: url, title: document.title}, document.title, url);\n    render();\n  })\n});\n\n"]}