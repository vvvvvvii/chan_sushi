{"version":3,"sources":["all.js"],"names":["firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","db","firestore","products","collection","stores","productCategory","storeCategory","render","document","querySelector","url","location","href","split","decodeURI","where","orderBy","onSnapshot","querySnapshot","str","forEach","item","product","data","imgUrl","title","price","$","html","querySelectorAll","innerHTML","parentElement","classList","add","storeArr","categoryObj","store","category","push","Object","values","flat","Infinity","renderStoreList","tel","time","address","ready","on","slideToggle","event","preventDefault","parent","siblings","removeClass","history","replaceState","value"],"mappings":"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","file":"all.js","sourcesContent":["\"use strict\"; // 寫了才能正常運行 jQuery\n\n// Firebase configuration\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDGSMcP5U44-K3qE0Y5lt77k4Bcq5sVKtU\",\n  authDomain: \"chan-sushi.firebaseapp.com\",\n  projectId: \"chan-sushi\",\n  storageBucket: \"chan-sushi.appspot.com\",\n  messagingSenderId: \"373508304619\",\n  appId: \"1:373508304619:web:6aa5d730627f26955a58ae\",\n  measurementId: \"G-F6FLCKX6C1\"\n};\n\n// 初始化 Firebase\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\nconst products = db.collection('menu');\nconst stores = db.collection('stores');\nlet productCategory = '握壽司';\nlet storeCategory = '尋找最近的店舖';\n\n// 渲染畫面\nfunction render(){\n  if(document.querySelector('#productList')){\n    // 產品列表頁\n    // 先確定網址有無參數\n    const url = location.href.split('?type=');\n    if(url[1]){\n      productCategory = decodeURI(url[1]);\n    }\n    // 抓 api\n    products.where('category','==',productCategory).orderBy('price').onSnapshot(querySnapshot => {\n      let str = '';\n      querySnapshot.forEach(item => {\n        const product = item.data();\n        str+=`\n        <div class=\"col-md-4 col-sm-6 col-12 mb-5\">\n          <div class=\"card border-0\">\n            <img src=\"${product.imgUrl}\" alt=\"${product.title}\" class=\"card-img\">\n            <div class=\"card-body\">\n              <h3 class=\"card-title mb-0\">${product.title}</h3>\n              <p class=\"text-center font-2\">${product.price} 元</p>\n            </div>\n          </div>\n        </div>\n        `\n      });\n      $('#productList').html(str);\n      $('#productListTitle').html(productCategory);\n      // 第一次進入頁面時， nav-item 即可正確顯示 active class\n      document.querySelectorAll('.nav-link').forEach(item=>{\n        if(item.innerHTML === productCategory){\n          item.parentElement.classList.add('active');\n        }\n      })\n    }); \n  }else if(document.querySelector('#storeList')){\n    // 店舖列表頁\n    let storeArr = [];\n    const url = location.href.split('?type=');\n    if(url[1]){\n      storeCategory = decodeURI(url[1]);\n    }\n    if(storeCategory === '尋找最近的店舖'){\n      stores.onSnapshot(querySnapshot=>{\n        // 店舖照地區北至南順序排列，先分類成物件裡的陣列，再取出放到 storeArr 渲染\n        const categoryObj = {\n          '台北':[],\n          '新北':[],\n          '台中':[],\n          '台南':[],\n          '高雄':[],\n        };\n        querySnapshot.forEach(item => {\n          const store = item.data();\n          categoryObj[store.category].push(store);\n        });\n        storeArr = Object.values(categoryObj).flat(Infinity);\n        renderStoreList(storeArr);\n      })\n    }else{\n      stores.where('category','==',storeCategory).onSnapshot(querySnapshot =>{\n        querySnapshot.forEach(item => {\n          storeArr.push(item.data());\n        });\n        renderStoreList(storeArr);\n      })\n    }\n  }\n}\nfunction renderStoreList(storeArr){\n  let str = '';\n  storeArr.forEach(store => {\n    str+=`\n    <div class=\"col-lg-4 col-md-6 col-12 mb-5\">\n      <div class=\"card\">\n        <img src=\"${store.imgUrl}\" alt=\"${store.category}${store.title}店\" class=\"card-img\">\n        <div class=\"card-body\">\n          <h3 class=\"card-title\">${store.category}${store.title}店</h3>\n          <ul>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-telephone-fill\"></i>\n              <span class=\"ml-1\">${store.tel}</span>\n            </li>\n            <li class=\"mb-2\">\n              <i class=\"bi bi-clock-fill\"></i>\n              <span class=\"ml-1\">${store.time[0]}:00 ~ ${store.time[1]}:00</span>\n            </li>\n            <li class=\"d-flex\">\n              <i class=\"bi bi-pin-angle-fill\"></i>\n              <span class=\"ml-1\">${store.address}</span>\n            </li>\n          </ul>\n        </div>\n        <div class=\"card-footer\">\n          <a href=\"#\" class=\"btn btn-secondary-light\">立即訂位</a>\n          <a href=\"#\" class=\"btn btn-outline-secondary-light ml-2\">外送點餐</a>\n        </div>\n      </div>\n    </div>\n    `\n  })\n  $('#storeList').html(str);\n}\n\n$(document).ready(function () {\n  // 渲染畫面\n  render();\n  // 漢堡選單\n  $('#collapseNavbarBtn').on('click', function(){\n    $('#collapse-navbar-menu').slideToggle();\n  })  \n  // 點選列表，沒被點到的移除 active class (render function 中會加上對應 active class)\n  $('.nav-link').on('click',function(event){\n    event.preventDefault(); \n    $(this).parent().siblings().removeClass('active');\n    // 如果是產品列表頁，要秀出對應資料\n    if($('#productList')){\n      productCategory = $(this)[0].innerHTML;\n      const url = `/product-list.html?type=${productCategory}`;\n      // 更新網址參數但不刷新整個頁面讓 nav-item active 消失\n      history.replaceState({url: url, title: document.title}, document.title, url);\n    }\n    render();\n  })\n  // 首頁搜尋店舖，跳轉畫面秀出對應資料\n  $('#searchStoreBtnIndex').on('click',function(){\n    storeCategory = $(this).siblings()[0].value;\n    const url = `/store-location.html?type=${storeCategory}`;\n    document.location = url;\n  })\n  // 店舖頁搜尋店舖，秀出對應資料\n  $('#searchStoreBtnLocation').on('click',function(){\n    storeCategory = $(this).siblings()[0].value;\n    const url = `/store-location.html?type=${storeCategory}`;\n    history.replaceState({url: url, title: document.title}, document.title, url);\n    render();\n  })\n});\n\n"]}